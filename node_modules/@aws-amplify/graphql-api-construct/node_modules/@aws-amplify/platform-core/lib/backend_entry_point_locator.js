"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.BackendLocator = void 0;
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
/**
 * Find the backend definition file in the customer app that represents a CDK app.
 */
class BackendLocator {
    rootDir;
    relativePath = path_1.default.join('amplify', 'backend');
    // Give preference to JS if that exists over TS in case customers have their own compilation process.
    supportedFileExtensions = ['.js', '.mjs', '.cjs', '.ts'];
    /**
     * Constructor for BackendLocator
     */
    constructor(rootDir = process.cwd()) {
        this.rootDir = rootDir;
    }
    locate = () => {
        for (const fileExtension of this.supportedFileExtensions) {
            if (fs_1.default.existsSync(path_1.default.resolve(this.rootDir, this.relativePath + fileExtension))) {
                return this.relativePath + fileExtension;
            }
        }
        throw new Error(`Amplify Backend not found in ${this.rootDir}. Amplify Backend must be defined in amplify/backend.(ts|js|cjs|mjs)`);
    };
}
exports.BackendLocator = BackendLocator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2VuZF9lbnRyeV9wb2ludF9sb2NhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2JhY2tlbmRfZW50cnlfcG9pbnRfbG9jYXRvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSw0Q0FBb0I7QUFDcEIsZ0RBQXdCO0FBRXhCOztHQUVHO0FBQ0gsTUFBYSxjQUFjO0lBUUk7SUFQckIsWUFBWSxHQUFHLGNBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBRXZELHFHQUFxRztJQUM3Rix1QkFBdUIsR0FBRyxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQ2pFOztPQUVHO0lBQ0gsWUFBNkIsVUFBa0IsT0FBTyxDQUFDLEdBQUcsRUFBRTtRQUEvQixZQUFPLEdBQVAsT0FBTyxDQUF3QjtJQUFHLENBQUM7SUFFaEUsTUFBTSxHQUFHLEdBQUcsRUFBRTtRQUNaLEtBQUssTUFBTSxhQUFhLElBQUksSUFBSSxDQUFDLHVCQUF1QixFQUFFO1lBQ3hELElBQ0UsWUFBRSxDQUFDLFVBQVUsQ0FDWCxjQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFlBQVksR0FBRyxhQUFhLENBQUMsQ0FDOUQsRUFDRDtnQkFDQSxPQUFPLElBQUksQ0FBQyxZQUFZLEdBQUcsYUFBYSxDQUFDO2FBQzFDO1NBQ0Y7UUFFRCxNQUFNLElBQUksS0FBSyxDQUNiLGdDQUFnQyxJQUFJLENBQUMsT0FBTyxzRUFBc0UsQ0FDbkgsQ0FBQztJQUNKLENBQUMsQ0FBQztDQUNIO0FBekJELHdDQXlCQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuLyoqXG4gKiBGaW5kIHRoZSBiYWNrZW5kIGRlZmluaXRpb24gZmlsZSBpbiB0aGUgY3VzdG9tZXIgYXBwIHRoYXQgcmVwcmVzZW50cyBhIENESyBhcHAuXG4gKi9cbmV4cG9ydCBjbGFzcyBCYWNrZW5kTG9jYXRvciB7XG4gIHByaXZhdGUgcmVsYXRpdmVQYXRoID0gcGF0aC5qb2luKCdhbXBsaWZ5JywgJ2JhY2tlbmQnKTtcblxuICAvLyBHaXZlIHByZWZlcmVuY2UgdG8gSlMgaWYgdGhhdCBleGlzdHMgb3ZlciBUUyBpbiBjYXNlIGN1c3RvbWVycyBoYXZlIHRoZWlyIG93biBjb21waWxhdGlvbiBwcm9jZXNzLlxuICBwcml2YXRlIHN1cHBvcnRlZEZpbGVFeHRlbnNpb25zID0gWycuanMnLCAnLm1qcycsICcuY2pzJywgJy50cyddO1xuICAvKipcbiAgICogQ29uc3RydWN0b3IgZm9yIEJhY2tlbmRMb2NhdG9yXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IHJvb3REaXI6IHN0cmluZyA9IHByb2Nlc3MuY3dkKCkpIHt9XG5cbiAgbG9jYXRlID0gKCkgPT4ge1xuICAgIGZvciAoY29uc3QgZmlsZUV4dGVuc2lvbiBvZiB0aGlzLnN1cHBvcnRlZEZpbGVFeHRlbnNpb25zKSB7XG4gICAgICBpZiAoXG4gICAgICAgIGZzLmV4aXN0c1N5bmMoXG4gICAgICAgICAgcGF0aC5yZXNvbHZlKHRoaXMucm9vdERpciwgdGhpcy5yZWxhdGl2ZVBhdGggKyBmaWxlRXh0ZW5zaW9uKVxuICAgICAgICApXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVsYXRpdmVQYXRoICsgZmlsZUV4dGVuc2lvbjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgQW1wbGlmeSBCYWNrZW5kIG5vdCBmb3VuZCBpbiAke3RoaXMucm9vdERpcn0uIEFtcGxpZnkgQmFja2VuZCBtdXN0IGJlIGRlZmluZWQgaW4gYW1wbGlmeS9iYWNrZW5kLih0c3xqc3xjanN8bWpzKWBcbiAgICApO1xuICB9O1xufVxuIl19