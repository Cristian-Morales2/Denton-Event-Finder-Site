 <!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="generator" content="Hugo 0.122.0">
    <title>Denton Event Finder</title>
    
    <link href="style.css" rel="stylesheet">
    <link href="feed_event.css" rel="stylesheet">
    <link href="dashboard.css" rel="stylesheet">
    <script src="topbar.js"></script>

    <style>
    </style>
  </head>
  
  
  
  <body>
    <!-- Top Navigation Bar -->
    <header class="top-bar">
    <div class="dropdown">
    <button class = "tb-hamburger-button"  onclick = tbDropToggle()>=</button>
    <!-- Add links to header dropdown here -->
      <div class="dropdown-content" id="tbDropdown">
        <a href="index.html">Dashboard</a>
        <a href="events.html">Events</a>
        <a href="food.html">Food</a>
        <a href="entertainment.html">Entertainment</a>
        <a href="clubs.html">Clubs</a>
        <a href="#account">Account</a>
        <a href="#settings">Settings</a>  
        <a href="signup.html">Create Account</a>
        <a href="signin.html">Log In</a>  
      </div>
    </div>
    <button class = "tb-text-button">Recommended</button>
    <button class = "tb-text-button">Upcoming</button>
    <input type="text" placeholder="Search"></input>
    <button class = "tb-create-button">
          <a href="create.html">+</a>  
    </button>
  </header>
  
  <!-- Temporary placement of main menu elements, feel free to alter -->

  <div class = "dashboard_top">
   <h1>Upcoming Events</h1>
   <div class = "feed">
    <div class = "feed_event_mini">
     <div class = "image_container">
      <img src="dev/demo/events/000001/0.jpg" alt="Jamiroquai in hat">
      <a>July 6th 2024</a>
     </div>
     <div class = "feed_event_mini_right">
      <h1>Jamiroquai at Rubber Gloves</h1>
      <hr>
      <a>Doors open at 6:00 pm. 30 dollar fee at the door or 20 dollars if ticketed online. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla...</a>
      <div class = "tag">
        Jazz
      </div>
     </div>
    </div>
    
   </div>
   <div id="event-list" class="event-list">
     <!-- This is where the events are going to go -->
   </div>
  </div>
  
 </body>
 <!-- Scripts to display the events -->
 <script>
     //Get access to the API
     const apiBaseUrl = 'https://9z3ygyqb5i.execute-api.us-east-1.amazonaws.com/prod'; 
  
     //Function to get the created events
     async function fetchEvents() {
            //Talk to the api and make a GET request
            try {
                const response = await fetch(`${apiBaseUrl}/list-events`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                //Display the event if the GET request worked
                if (response.ok) {
                    const events = await response.json();
                    displayEvents(events);
                } 
                //Log error it GET request didn't work
                else {
                    console.error('Failed to fetch events');
                }
            } catch (error) {
                console.error('Error:', error);
            }
     }

     //Function to display the events
     function displayEvents(events) {
            const eventList = document.getElementById('event-list');
            eventList.innerHTML = '';

            events.forEach(event => {
                //Create a blank event
                const eventElement = document.createElement('div');
                eventElement.classList.add('event');
             
                //Add event title
                const title = document.createElement('h2');
                title.textContent = event.title;

                //Add event description
                const description = document.createElement('p');
                description.textContent = event.description;

                //Add event address
                const address = document.createElement('p');
                address.textContent = `Address: ${event.address}`;

                //Add event date
                const date = document.createElement('p');
                date.textContent = `Date: ${event.date}`;

                //Add event time
                const time = document.createElement('p');
                time.textContent = `Time: ${event.time}`;

                //Add event image
                const imageContainer = document.createElement('div');
                imageContainer.classList.add('image-container');
                event.imageUrls.forEach(url => {
                    const img = document.createElement('img');
                    img.src = url;
                    img.alt = event.title;
                    imageContainer.appendChild(img);
                });

                //Append event info to the blank event
                eventElement.appendChild(title);
                eventElement.appendChild(description);
                eventElement.appendChild(address);
                eventElement.appendChild(date);
                eventElement.appendChild(time);
                eventElement.appendChild(imageContainer);

                //Append event to the page
                eventList.appendChild(eventElement);
            });
     }

     //Make sure that fetch events still runs while the page is up
     document.addEventListener('DOMContentLoaded', fetchEvents);
 </script>
</html>

